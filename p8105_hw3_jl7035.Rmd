---
title: "p8105_hw3_jl7035"
author: "Jeffrey Lin"
date: "2024-10-12"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Necessary Libraries 

```{r}
library(tidyverse)
library(ggplot2)
library(ggridges)
```
## Problem 1
```{r}

```


## Problem 2

Load in and clean each dataset
```{r}
demographic_df <- 
  read_csv("Data/nhanes_covar.csv",
    na = c("", "NA", "."),
    skip = 4
  ) %>% 
  janitor::clean_names() %>% 
  mutate(
    sex = factor(
      sex, 
      levels = c("1", "2"), 
      labels = c("male", "female")),
    education = factor(
      education,
      levels = c("1", "2", "3"),
      labels = c("Less than high school", "High School Equivalent", 
                 "More than high school")
    )
  ) %>% 
  filter(
    age >= 21
  ) %>% 
  drop_na()
  
head(demographic_df)
  
accelerometer_df <- 
  read_csv("Data/nhanes_accel.csv",
    na = c("NA", "", ".")
  ) %>%  
  janitor::clean_names() %>%
  pivot_longer(
    min1:min1440,
    names_to = "Minute",
    values_to = "MIMS"
  ) %>% 
  mutate(
    Minute = str_remove(Minute, "min")
  )
  

```
Join dfs together
```{r}
accel_participant_df <-
  left_join(
    demographic_df, 
    accelerometer_df, 
    by = "seqn")

anti_join(demographic_df, accel_participant_df)
```


Produce reader-friendly table for number of men and women in each education
category
```{r}
demographic_df %>% 
  group_by(sex, education) %>% 
  count() %>% 
  pivot_wider(
    names_from = education,
    values_from = n
  ) %>% 
  knitr::kable()

```
Looking at the count of the number of men and women in each education category,
we can see that there only appears to be a major difference in the number of 
men and women high school equivalent category, such that there were 12 more 
male participants than female participants with a high school equivalent 
education. Interestingly, more female participants had more than high school
education compared to men, but only by a difference of +3.

create visualization of age distribution for each education category
```{r}
ggplot(demographic_df, aes(x = education, y = age, fill = sex)) +
  geom_boxplot(outliers = TRUE)

```
Examining the distribution of age by educational level for male and female 
participants. We can once again notice some differences. Firstly, we can note 
that while the median age of men and women in the less than high school and more
than high school categories are relatively similar, we see a more substantial 
difference in the high school equivalent category. Here, female participants 
have a median age hovering around 62-63, which is higher than the male 
equivalent, at roughly 54. Looking at the spread of values in each of the 3 
categories, we can notice, perhaps a tiny bit of skew. In the less than 
high school and high school equivalent categories, for both men and women,
the distance between median and q3 is slightly smaller and suggestive of a 
potential slight left skew. For the more than high school equivalent, the median
is closer to q1, and potentially suggests a slight right skew. Lastly, we can 
see that the whole distribution of ages for the female high school equivalent 
category is shifted upwards compared to the male counterpart, as the q1 and q3 
are higher in the female category vs the male. 

compare total activity for men and women and by education
```{r}
demographic_df <- accel_participant_df %>% 
  group_by(seqn) %>% 
  select(MIMS, seqn) %>% 
  summarise(total_activity = sum(MIMS)) %>% 
  left_join(demographic_df, by = "seqn") %>% 
  relocate(total_activity, .after = education)

ggplot(demographic_df, aes(x = age, y = total_activity, color = sex)) +
  geom_point( alpha = 0.5) +
  geom_smooth(aes(color = sex), se = FALSE) +
  facet_grid(.~education)


```



## Problem 3
```{r}

```

